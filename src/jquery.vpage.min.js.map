{"version":3,"sources":["jquery.vpage.js"],"names":["$","vpage","storage","api","this","add_state","param","state","vpage_name","name","key","history","get_url_param","sPageURL","window","location","search","substring","sURLVariables","split","i","length","sParameterName","onload","onpop","onpopstate","event","obj","listen","trigger","type","set","val","get","fn","on","before","pushState","title","url","after","jQuery"],"mappings":";CAAC,SAAWA,GAIRA,EAAEC,SACFD,EAAEC,MAAMC,WAERF,EAAEC,MAAME,IAAM,GAAI,YAGdC,KAAKC,UAAY,SAAUC,GAEvB,MADAA,GAAMC,MAAMC,WAAaF,EAAMG,KACxBH,EAAMC,OAIjBH,KAAKM,IAAM,WACP,MAAOC,SAAQJ,MAAMC,YAIzBJ,KAAKQ,cAAgB,SAAUF,GAG3B,IAAK,GAFDG,GAAWC,OAAOC,SAASC,OAAOC,UAAU,GAC5CC,EAAgBL,EAASM,MAAM,KAC1BC,EAAI,EAAGA,EAAIF,EAAcG,OAAQD,IAAI,CAC1C,GAAIE,GAAiBJ,EAAcE,GAAGD,MAAM,IAC5C,IAAIG,EAAe,IAAMZ,EACrB,MAAOY,GAAe,KASlClB,KAAKmB,OAAS,WAGV,GAAIf,GAAaR,EAAEC,MAAME,IAAIS,cAAc,SAO3C,OALIJ,IAEAR,EAAEC,MAAMC,QAAQM,GAAYe,SAGzBvB,EAAEC,MAAME,KAMnBC,KAAKoB,MAAQ,WAETV,OAAOW,WAAc,SAAUC,GAE3B,GAAIf,QAAQJ,OAASI,QAAQJ,MAAMC,WAAW,CAC1C,GAAIE,GAAMV,EAAEC,MAAME,IAAIO,MAClBiB,EAAM3B,EAAEC,MAAMC,QAAQQ,EAC1BiB,GAAIH,QAER,MAAOxB,GAAEC,MAAME,OAU3BH,EAAEC,MAAM2B,OAAS,WAEb5B,EAAEC,MAAME,IAAIoB,SAASC,SASzBxB,EAAEC,MAAM4B,QAAU,SAAUpB,EAAMqB,GAClB,UAARA,EACA9B,EAAEC,MAAMC,QAAQO,GAAMc,SAET,SAARO,GACL9B,EAAEC,MAAMC,QAAQO,GAAMe,SAK9BxB,EAAEC,MAAM8B,IAAM,SAAUtB,EAAMC,EAAKsB,GAC/BhC,EAAEC,MAAMC,QAAQO,GAAMC,GAAOsB,GAIjChC,EAAEC,MAAMgC,IAAM,SAAUxB,EAAMC,GAC1B,MAAOV,GAAEC,MAAMC,QAAQO,GAAMC,IAgBjCV,EAAEkC,GAAGjC,MAAQ,SAAUK,GAGnBN,EAAEC,MAAMC,QAAQI,EAAMG,MAAQH,EAE9BF,KAAK+B,GAAG7B,EAAMoB,MAAO,WAEbpB,EAAM8B,QAAQ9B,EAAM8B,OAAO9B,GAE/BA,EAAMC,MAAQP,EAAEC,MAAME,IAAIE,UAAUC,GAEpCK,QAAQ0B,UAAU/B,EAAMC,MAAOD,EAAMgC,MAAOhC,EAAMiC,KAE9CjC,EAAMkC,OAAOlC,EAAMkC,MAAMlC,OAItCmC","file":"jquery.vpage.min.js","sourcesContent":["(function ( $ ) {\r\n\r\n    var version = \"1.0.0\";\r\n\r\n    $.vpage = {};\r\n    $.vpage.storage = {}\r\n\r\n    $.vpage.api = new function (){\r\n\r\n        // 添加新的辨識\r\n        this.add_state = function (param){\r\n            param.state.vpage_name = param.name;\r\n            return param.state;\r\n        }\r\n\r\n        // 取得堆中的 vpage 名稱\r\n        this.key = function (){\r\n            return history.state.vpage_name;\r\n        }\r\n\r\n        // 取得網址的 get 參數，例如 ?\r\n        this.get_url_param = function (key){\r\n            var sPageURL = window.location.search.substring(1);\r\n            var sURLVariables = sPageURL.split('&');\r\n            for (var i = 0; i < sURLVariables.length; i++){\r\n                var sParameterName = sURLVariables[i].split('=');\r\n                if (sParameterName[0] == key){\r\n                    return sParameterName[1];\r\n                }\r\n            }\r\n        }​\r\n\r\n        /**\r\n         * 畫面進入時所觸發的事件\r\n         * 若要啟用，網址需要夾帶有 GET 參數 \"onload\"\r\n         */\r\n        this.onload = function (){\r\n\r\n            // 取得 GET 的 onload 值，作為辨識的鍵\r\n            var vpage_name = $.vpage.api.get_url_param(\"onload\");\r\n\r\n            if (vpage_name) {\r\n                //呼叫對應的 onload()\r\n                $.vpage.storage[vpage_name].onload();\r\n            }\r\n\r\n            return $.vpage.api;\r\n        }\r\n\r\n        /**\r\n         * 切換上下頁面所觸發的事件\r\n         */\r\n        this.onpop = function (){\r\n\r\n            window.onpopstate  = function (event){\r\n                //如果有放入堆疊的話才執行\r\n                if (history.state && history.state.vpage_name){\r\n                    var key = $.vpage.api.key();\r\n                    var obj = $.vpage.storage[key];\r\n                    obj.onpop();\r\n                }\r\n                return $.vpage.api;\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n\r\n    \r\n\r\n    // 監聽 vpage 設定的 onload 與 onpop 事件\r\n    $.vpage.listen = function(){\r\n\r\n        $.vpage.api.onload().onpop();\r\n\r\n    }\r\n\r\n    /**\r\n     * 由外部手動觸發\r\n     * @param   name         vpage 的名稱\r\n     * @param   type         onload | onpop\r\n     */\r\n    $.vpage.trigger = function (name, type){\r\n        if (type == \"onload\"){\r\n            $.vpage.storage[name].onload();\r\n        }\r\n        else if (type == \"onpop\") {\r\n            $.vpage.storage[name].onpop();\r\n        }\r\n    }\r\n\r\n    // 設定\r\n    $.vpage.set = function (name, key, val){\r\n        $.vpage.storage[name][key] = val;\r\n    }\r\n\r\n    // 取得設定\r\n    $.vpage.get = function (name, key){\r\n        return $.vpage.storage[name][key];\r\n    }\r\n\r\n\r\n    /**\r\n     * [vpage description]\r\n     * @param  param.name       為該模型命名\r\n     * @param  param.state      history.pushState 物件     \r\n     * @param  param.event      on 的事件\r\n     * @param  param.before()   (選)on 回呼\r\n     * @param  param.after()    (選)on 回呼\r\n     * @param  param.title      (選)變更的網頁標題\r\n     * @param  param.url        (選)變更的網址\r\n     * @param  param.onload     (選)\r\n     * @param  param.onpop      (選)\r\n     */\r\n    $.fn.vpage = function (param){\r\n\r\n        // 將設定放到倉儲，使用 vpage 的名稱作為鍵\r\n        $.vpage.storage[param.name] = param;\r\n\r\n        this.on(param.event, function (){\r\n\r\n            if (param.before) param.before(param);\r\n\r\n            param.state = $.vpage.api.add_state(param);\r\n\r\n            history.pushState(param.state, param.title, param.url);\r\n\r\n            if (param.after) param.after(param);\r\n        })\r\n    }\r\n\r\n}( jQuery ));\r\n"]}