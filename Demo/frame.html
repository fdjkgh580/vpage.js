<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0">
    <title>Document</title>
    <script src="jquery-3.1.0.min.js"></script>
    <script src="../src/jquery.vpage.js"></script>
    <link rel="stylesheet" type="text/css" href="stylesheets/frame.css">
<script>
$(function (){

    function _selected_item(selector){
        $(".item").removeClass("selected");
        $(selector).addClass('selected');
    }
    function _show_content(selector_target){
        $(".content").find(".article").addClass("hidden");
        $(".content").find(selector_target).removeClass("hidden");
    }

    function _init_item(){
        $(".item").removeClass("selected");
        $(".item[data-target=about]").addClass("selected");
        $(".content").find(".article").addClass("hidden");
        $(".content").find(".article.about").removeClass("hidden");
    }

    function _init_box(){
        $(".content").find(".box").removeClass("selected");
    }

    $.vpage.default = function (){
        _init_item();
        _init_box();
    }


    $(".item").vpage({
        name: "frame",
        event: "click",
        prepare: function (){
            var target = $(this).attr("data-target");
            $.vpage.set("frame", "url", "?onload=frame&target=" + target)
        },
        do: function (){
            var class_name = $(this).attr("data-target");

            _selected_item(this);
            _show_content("." + class_name);
            return false;
        },
        onload: function (){
            var target = $.vpage.get_url_param("target");
            _selected_item(".item[data-target="+target+"]");
            _show_content("." + target);
        },
        onpop: function (){
            var target = $.vpage.get_url_param("target");

            if (target === undefined) {
                _init_item();
            }
            else {
                _selected_item(".item[data-target="+target+"]");
                _show_content("." + target);
            }
            
        }
    })
    $.vpage.listen();


    $(".box").vpage({
        name: "box",
        event: "click",
        url_get_onload_key: "onload_2",
        vs: this,
        prepare: function (){
            var id = $(this).attr("id");
            $.vpage.set("box", "url", "?onload_2=box&id=" + id);
        },
        do: function (){
            var id = $(this).attr("id");
            $.vpage.get("box").selected(id);
        },
        onload: function (){
            _init_item();

            var id = $.vpage.get_url_param("id");
            $.vpage.get("box").selected(id);
        },
        onpop: function (){
            _init_item()            
            var id = $.vpage.get_url_param("id");
            $.vpage.get("box").selected(id);
        },
        selected: function (id){
            $.vpage.get("box").reset();
            $(".box[id="+id+"]").addClass("selected");
        },
        reset: function (){
            $(".box").removeClass("selected");
        }
    })

    $.vpage.listen();




    if (!$.vpage.get_url_param("onload") || !$.vpage.get_url_param("onload_2")) {
        _init_item();
        _init_box();
    }

})
</script>
</head>
<body>

    <div class="container">
        <header>
            <a class="item" href="" data-target="about">項目01</a>
            <a class="item" href="" data-target="news">項目02</a>
            <a class="item" href="" data-target="product">項目03</a>
            <a class="item" href="" data-target="contact">項目04</a>
            <a class="item" href="" data-target="profile">項目05</a>
        </header>
        <div class="content">
            <div class="article about hidden">
                <div class="text">歡迎使用 Vpage.js</div>
                <div class="box" id="1"></div>
                <div class="box" id="2"></div>
                <div class="box" id="3"></div>
                <div class="box" id="4"></div>
                <div class="box" id="5"></div>
            </div>
            <div class="article news hidden">內容02</div>
            <div class="article product hidden">內容03</div>
            <div class="article contact hidden">內容04</div>
            <div class="article profile hidden">內容05</div>
        </div>
    </div>

</body>
</html>